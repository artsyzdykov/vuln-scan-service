package models

import "time"

type ScanResultWrapper struct {
	ScanResults ScanResult `json:"scanResults"`
}

type ScanResult struct {
	ScanID          string          `json:"scan_id"`
	Timestamp       time.Time       `json:"timestamp"`
	ResourceType    string          `json:"resource_type"`
	ResourceName    string          `json:"resource_name"`
	Vulnerabilities []Vulnerability `json:"vulnerabilities"`
}

type Vulnerability struct {
	ID             string    `json:"id" db:"id"`
	Severity       string    `json:"severity" db:"severity"`
	CVSS           float64   `json:"cvss" db:"cvss"`
	Status         string    `json:"status" db:"status"`
	PackageName    string    `json:"package_name" db:"package_name"`
	CurrentVersion string    `json:"current_version" db:"current_version"`
	FixedVersion   string    `json:"fixed_version" db:"fixed_version"`
	Description    string    `json:"description" db:"description"`
	PublishedDate  time.Time `json:"published_date" db:"published_date"`
	Link           string    `json:"link" db:"link"`
	RiskFactors    []string  `json:"risk_factors" db:"risk_factors"`
	SourceFile     string    `json:"source_file" db:"source_file"`
	ScanTime       time.Time `json:"scan_time" db:"scan_time"`
	ResourceType   string    `json:"resource_type" db:"resource_type"`
	ResourceName   string    `json:"resource_name" db:"resource_name"`
	ScanID         string    `json:"scan_id" db:"scan_id"`
}
